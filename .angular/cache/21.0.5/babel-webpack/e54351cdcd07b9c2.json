{"ast":null,"code":"import { Router, NavigationEnd } from '@angular/router';\nimport { Platform } from '@ionic/angular';\nimport { SplashScreen } from '@awesome-cordova-plugins/splash-screen/ngx';\nimport { StatusBar } from '@awesome-cordova-plugins/status-bar/ngx';\nimport { BFGUserService } from './services/bfg-user.service';\nimport { BFGPushNotificationService } from './services/bfg-push-notification.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/bfg-user.service\";\nimport * as i2 from \"./services/bfg-push-notification.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@awesome-cordova-plugins/splash-screen/ngx\";\nimport * as i6 from \"@awesome-cordova-plugins/status-bar/ngx\";\nfunction AppComponent_ng_container_9_ion_list_1_ion_menu_toggle_1_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵdomElementStart(0, \"ion-item\", 12)(1, \"ion-label\", 13);\n    i0.ɵɵtext(2);\n    i0.ɵɵdomElementEnd()();\n  }\n  if (rf & 2) {\n    const p_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵdomProperty(\"routerLink\", p_r1.url);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", p_r1.title, \" \");\n  }\n}\nfunction AppComponent_ng_container_9_ion_list_1_ion_menu_toggle_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵdomElementStart(0, \"ion-menu-toggle\", 10);\n    i0.ɵɵdomTemplate(1, AppComponent_ng_container_9_ion_list_1_ion_menu_toggle_1_ion_item_1_Template, 3, 2, \"ion-item\", 11);\n    i0.ɵɵdomElementEnd();\n  }\n  if (rf & 2) {\n    const p_r1 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵdomProperty(\"ngIf\", ctx_r1.showMenuItem(p_r1));\n  }\n}\nfunction AppComponent_ng_container_9_ion_list_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵdomElementStart(0, \"ion-list\", 8);\n    i0.ɵɵdomTemplate(1, AppComponent_ng_container_9_ion_list_1_ion_menu_toggle_1_Template, 2, 1, \"ion-menu-toggle\", 9);\n    i0.ɵɵdomElementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵdomProperty(\"ngForOf\", ctx_r1.appPages);\n  }\n}\nfunction AppComponent_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵdomElementContainerStart(0);\n    i0.ɵɵdomTemplate(1, AppComponent_ng_container_9_ion_list_1_Template, 2, 1, \"ion-list\", 7);\n    i0.ɵɵdomElementContainerEnd();\n  }\n  if (rf & 2) {\n    const loaded_r3 = ctx.ngIf;\n    i0.ɵɵadvance();\n    i0.ɵɵdomProperty(\"ngIf\", loaded_r3);\n  }\n}\nfunction AppComponent_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵdomElementContainerStart(0);\n    i0.ɵɵdomElementStart(1, \"ion-grid\")(2, \"ion-row\")(3, \"ion-col\", 14)(4, \"a\", 15);\n    i0.ɵɵdomElement(5, \"ion-icon\", 16);\n    i0.ɵɵtext(6, \" Available on Android\");\n    i0.ɵɵdomElementEnd();\n    i0.ɵɵdomElement(7, \"br\");\n    i0.ɵɵdomElementStart(8, \"a\", 17);\n    i0.ɵɵdomElement(9, \"ion-icon\", 18);\n    i0.ɵɵtext(10, \" Available on iOS!\");\n    i0.ɵɵdomElementEnd()()()();\n    i0.ɵɵdomElementContainerEnd();\n  }\n}\nfunction AppComponent_ion_footer_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵdomElementStart(0, \"ion-footer\")(1, \"ion-button\", 19);\n    i0.ɵɵdomListener(\"click\", function AppComponent_ion_footer_12_Template_ion_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.bfgUser.logout());\n    });\n    i0.ɵɵdomElementStart(2, \"strong\");\n    i0.ɵɵtext(3, \"LOGOUT\");\n    i0.ɵɵdomElementEnd()()();\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    bfgUser;\n    push;\n    platform;\n    router;\n    splashScreen;\n    statusBar;\n    onWelcome = false;\n    showMenu = false;\n    appPages = [\n    // Chef/Super chef links\n    {\n      title: 'Announcements',\n      url: '/announcements',\n      icon: 'list-box',\n      allowChef: true,\n      allowSuperChef: true\n    }, {\n      title: 'Houses',\n      url: '/house-list',\n      icon: 'home',\n      allowChef: true,\n      allowSuperChef: true\n    }, {\n      title: 'House Menus',\n      url: '/house-menus',\n      icon: 'calendar',\n      allowSuperChef: true\n    }, {\n      title: 'Chat',\n      url: '/chat-list',\n      icon: 'chatboxes',\n      allowChef: true,\n      allowSuperChef: true,\n      app_function_key: 'chat'\n    },\n    // Student links\n    {\n      title: 'Dashboard',\n      url: '/dashboard',\n      icon: 'speedometer',\n      allowStudent: true\n    }, {\n      title: 'Weekly Menu',\n      url: '/week-menu',\n      icon: 'book',\n      allowStudent: true\n    }, {\n      title: 'Edit Meal Plan',\n      url: '/edit-meal-plan',\n      icon: 'calendar',\n      allowStudent: true\n    }, {\n      title: 'Ratings',\n      url: '/ratings',\n      icon: 'star',\n      allowStudent: true,\n      app_function_key: ['meal_ratings', 'chef_ratings']\n    }, {\n      title: 'Requests & Comments',\n      url: '/requests',\n      icon: 'clipboard',\n      allowStudent: true,\n      app_function_key: 'request_comments'\n    }, {\n      title: 'Chat',\n      url: '/chat',\n      icon: 'chatboxes',\n      allowStudent: true,\n      app_function_key: 'chat'\n    }, {\n      title: 'Profile',\n      url: '/profile',\n      icon: 'settings',\n      allowStudent: true\n    }, {\n      title: 'Technical Support',\n      url: '/technical-support',\n      icon: 'information-circle',\n      alwaysAvailable: true\n    }, {\n      title: 'Login',\n      url: '/login',\n      icon: 'calendar',\n      publicOnly: true\n    }];\n    constructor(bfgUser, push, platform, router, splashScreen, statusBar) {\n      this.bfgUser = bfgUser;\n      this.push = push;\n      this.platform = platform;\n      this.router = router;\n      this.splashScreen = splashScreen;\n      this.statusBar = statusBar;\n      this.router.events.subscribe(event => {\n        if (event instanceof NavigationEnd) {\n          this.onWelcome = event.urlAfterRedirects == '/welcome';\n          // Hide loading indicator\n        }\n      });\n    }\n    ngOnInit() {\n      this.initializeApp();\n    }\n    clearAllCaches() {\n      try {\n        // Clear browser caches\n        if ('caches' in window) {\n          caches.keys().then(cacheNames => {\n            cacheNames.forEach(cacheName => {\n              caches.delete(cacheName);\n            });\n          });\n        }\n        // Clear service worker caches\n        if ('serviceWorker' in navigator) {\n          navigator.serviceWorker.getRegistrations().then(registrations => {\n            registrations.forEach(registration => {\n              registration.unregister();\n            });\n          });\n        }\n        // Clear localStorage except essential items\n        const keysToKeep = ['user', 'push-notification-config'];\n        const allKeys = Object.keys(localStorage);\n        allKeys.forEach(key => {\n          if (!keysToKeep.includes(key)) {\n            localStorage.removeItem(key);\n          }\n        });\n        // Clear sessionStorage\n        sessionStorage.clear();\n        console.log('All caches cleared successfully');\n      } catch (error) {\n        console.warn('Error clearing caches:', error);\n      }\n    }\n    initializeApp() {\n      console.log('Initializing app');\n      // Clear all caches on app start\n      this.clearAllCaches();\n      // Add error handling for platform ready\n      this.platform.ready().then(() => {\n        console.log('Platform ready');\n        // Handle back button with error handling\n        try {\n          this.platform.backButton.subscribeWithPriority(9999, () => {\n            // Do nothing\n          });\n        } catch (error) {\n          console.warn('Back button handler not available:', error);\n        }\n        // Handle document back button with error handling\n        try {\n          document.addEventListener(\"backbutton\", function (e) {\n            e.preventDefault();\n          }, false);\n        } catch (error) {\n          console.warn('Document back button handler not available:', error);\n        }\n        // Handle StatusBar with error handling\n        try {\n          if (this.statusBar && typeof this.statusBar.styleDefault === 'function') {\n            this.statusBar.styleDefault();\n          }\n        } catch (error) {\n          console.warn('StatusBar plugin not available:', error);\n        }\n        // Handle SplashScreen with error handling\n        try {\n          if (this.splashScreen && typeof this.splashScreen.hide === 'function') {\n            this.splashScreen.hide();\n          }\n        } catch (error) {\n          console.warn('SplashScreen plugin not available:', error);\n        }\n        console.log('Platform ready');\n        // Initialize push notifications with error handling\n        if (this.push && typeof this.push.init === 'function') {\n          this.push.init().then(success => {\n            console.log('Push notifications initialized:', success);\n          }).catch(error => {\n            console.warn('Push notifications failed to initialize:', error);\n            // Continue app initialization even if push notifications fail\n          });\n        } else {\n          console.warn('Push notification service not available');\n        }\n      }).catch(err => {\n        console.error('Platform initialization failed:', err);\n        console.log('Platform not ready');\n        // Try to hide splash screen even if platform is not ready\n        try {\n          if (this.splashScreen && typeof this.splashScreen.hide === 'function') {\n            this.splashScreen.hide();\n          }\n        } catch (error) {\n          console.warn('Could not hide splash screen:', error);\n        }\n      });\n    }\n    isDesktop() {\n      try {\n        return this.platform.is('desktop') || this.platform.is('mobileweb');\n      } catch (error) {\n        console.warn('Platform check failed:', error);\n        return false;\n      }\n    }\n    showMenuItem(page) {\n      if (!this.bfgUser) return false;\n      var me = this;\n      let p = page,\n        authenticated = this.bfgUser.isAuthenticated();\n      var showMenuItem = false,\n        origShowMenuItem = authenticated && p.requireAuthentication || !authenticated && p.publicOnly || p.alwaysAvailable;\n      showMenuItem = origShowMenuItem;\n      if (page.allowStudent && !showMenuItem) {\n        showMenuItem = this.bfgUser.isStudent();\n      }\n      if (page.allowChef && !showMenuItem) {\n        showMenuItem = this.bfgUser.isChef();\n      }\n      if (page.allowSuperChef && !showMenuItem) {\n        showMenuItem = this.bfgUser.isSuperChef();\n      }\n      if (showMenuItem && this.isStudent() && page.app_function_key) {\n        var funcKeys = Array.isArray(page.app_function_key) ? page.app_function_key : [page.app_function_key];\n        var enable = false;\n        funcKeys.forEach(function (val) {\n          enable = me.bfgUser.appFunctionEnabled(val) || enable;\n        });\n        showMenuItem = enable;\n      }\n      return showMenuItem;\n    }\n    isStudent() {\n      try {\n        return this.bfgUser.isStudent();\n      } catch (error) {\n        console.warn('Student check failed:', error);\n        return false;\n      }\n    }\n    isChef() {\n      try {\n        return this.bfgUser.isChef();\n      } catch (error) {\n        console.warn('Chef check failed:', error);\n        return false;\n      }\n    }\n    isSuperChef() {\n      try {\n        return this.bfgUser.isSuperChef();\n      } catch (error) {\n        console.warn('SuperChef check failed:', error);\n        return false;\n      }\n    }\n    showLogout() {\n      try {\n        let authenticated = this.bfgUser.isAuthenticated();\n        return authenticated;\n      } catch (error) {\n        console.warn('Authentication check failed:', error);\n        return false;\n      }\n    }\n    static ɵfac = function AppComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AppComponent)(i0.ɵɵdirectiveInject(i1.BFGUserService), i0.ɵɵdirectiveInject(i2.BFGPushNotificationService), i0.ɵɵdirectiveInject(i3.Platform), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.SplashScreen), i0.ɵɵdirectiveInject(i6.StatusBar));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AppComponent,\n      selectors: [[\"app-root\"]],\n      decls: 14,\n      vars: 5,\n      consts: [[1, \"main-nav\"], [\"color\", \"secondary\"], [\"color\", \"tertiary\", 1, \"dark-grid\"], [\"size\", \"8\", \"offset\", \"2\"], [\"src\", \"../assets/img/best-fed-greeks-logo.png\", \"alt\", \"best fed greeks logo\", \"padding\", \"\"], [4, \"ngIf\"], [\"main\", \"\"], [\"color\", \"secondary\", \"class\", \"menu-link-list\", 4, \"ngIf\"], [\"color\", \"secondary\", 1, \"menu-link-list\"], [\"autoHide\", \"false\", 4, \"ngFor\", \"ngForOf\"], [\"autoHide\", \"false\"], [\"routerLinkActive\", \"active\", \"routerDirection\", \"root\", \"color\", \"secondary\", 3, \"routerLink\", 4, \"ngIf\"], [\"routerLinkActive\", \"active\", \"routerDirection\", \"root\", \"color\", \"secondary\", 3, \"routerLink\"], [\"color\", \"tertiary\"], [\"size\", \"12\", 1, \"store-info\"], [\"target\", \"_blank\", \"href\", \"https://play.google.com/store/apps/details?id=com.bestfedgreeks.app\"], [\"ios\", \"md-appstore\", \"md\", \"md-appstore\"], [\"target\", \"_blank\", \"href\", \"https://apps.apple.com/us/app/id1525132971\"], [\"ios\", \"ios-appstore\", \"md\", \"ios-appstore\"], [\"bfg-btm-btn\", \"\", \"expand\", \"full\", \"size\", \"large\", \"color\", \"primary\", \"expand\", \"block\", \"size\", \"large\", 3, \"click\"]],\n      template: function AppComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵdomElementStart(0, \"ion-app\")(1, \"ion-menu\", 0)(2, \"ion-header\");\n          i0.ɵɵdomElement(3, \"ion-toolbar\");\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomElementStart(4, \"ion-content\", 1)(5, \"ion-grid\", 2)(6, \"ion-row\")(7, \"ion-col\", 3);\n          i0.ɵɵdomElement(8, \"img\", 4);\n          i0.ɵɵdomElementEnd()()();\n          i0.ɵɵdomTemplate(9, AppComponent_ng_container_9_Template, 2, 1, \"ng-container\", 5);\n          i0.ɵɵpipe(10, \"async\");\n          i0.ɵɵdomTemplate(11, AppComponent_ng_container_11_Template, 11, 0, \"ng-container\", 5);\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomTemplate(12, AppComponent_ion_footer_12_Template, 4, 0, \"ion-footer\", 5);\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomElement(13, \"ion-router-outlet\", 6);\n          i0.ɵɵdomElementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(9);\n          i0.ɵɵdomProperty(\"ngIf\", i0.ɵɵpipeBind1(10, 3, ctx.bfgUser.userConfigLoaded));\n          i0.ɵɵadvance(2);\n          i0.ɵɵdomProperty(\"ngIf\", ctx.isDesktop());\n          i0.ɵɵadvance();\n          i0.ɵɵdomProperty(\"ngIf\", ctx.showLogout());\n        }\n      },\n      encapsulation: 2\n    });\n  }\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}