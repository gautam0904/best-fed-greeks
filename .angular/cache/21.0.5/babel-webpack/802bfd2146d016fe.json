{"ast":null,"code":"import { Router } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nexport let ErrorHandlerService = /*#__PURE__*/(() => {\n  class ErrorHandlerService {\n    router;\n    errorCount = 0;\n    MAX_ERRORS = 10;\n    ERROR_RESET_INTERVAL = 60000; // 1 minute\n    constructor(router) {\n      this.router = router;\n      this.setupGlobalErrorHandling();\n    }\n    setupGlobalErrorHandling() {\n      // Handle unhandled promise rejections\n      window.addEventListener('unhandledrejection', event => {\n        console.error('Unhandled promise rejection:', event.reason);\n        this.handleError(event.reason, 'Unhandled Promise Rejection');\n        event.preventDefault();\n      });\n      // Handle global errors\n      window.addEventListener('error', event => {\n        console.error('Global error:', event.error);\n        this.handleError(event.error, 'Global Error');\n      });\n      // Handle Angular errors\n      window.addEventListener('error', event => {\n        if (event.error && event.error.message) {\n          console.error('Angular error:', event.error);\n          this.handleError(event.error, 'Angular Error');\n        }\n      });\n      // Reset error count periodically\n      setInterval(() => {\n        this.errorCount = 0;\n      }, this.ERROR_RESET_INTERVAL);\n    }\n    handleError(error, context = 'Application Error') {\n      try {\n        this.errorCount++;\n        // Log the error\n        console.error(`${context}:`, error);\n        // If too many errors, show a general error message\n        if (this.errorCount > this.MAX_ERRORS) {\n          this.showGeneralErrorMessage();\n          return;\n        }\n        // Handle specific error types\n        if (error && error.message) {\n          if (error.message.includes('Network') || error.message.includes('connection')) {\n            this.showNetworkErrorMessage();\n          } else if (error.message.includes('authentication') || error.message.includes('token')) {\n            this.handleAuthenticationError();\n          } else if (error.message.includes('permission') || error.message.includes('access')) {\n            this.showPermissionErrorMessage();\n          } else {\n            this.showGeneralErrorMessage();\n          }\n        } else {\n          this.showGeneralErrorMessage();\n        }\n      } catch (handlerError) {\n        console.error('Error in error handler:', handlerError);\n        this.showGeneralErrorMessage();\n      }\n    }\n    showNetworkErrorMessage() {\n      try {\n        this.showToast('Network Error', 'Please check your internet connection and try again.');\n      } catch (error) {\n        console.error('Error showing network message:', error);\n      }\n    }\n    showPermissionErrorMessage() {\n      try {\n        this.showToast('Permission Error', 'You do not have permission to perform this action.');\n      } catch (error) {\n        console.error('Error showing permission message:', error);\n      }\n    }\n    showGeneralErrorMessage() {\n      try {\n        this.showToast('Error', 'An unexpected error occurred. Please try again.');\n      } catch (error) {\n        console.error('Error showing general message:', error);\n      }\n    }\n    handleAuthenticationError() {\n      try {\n        // Clear any stored authentication data\n        localStorage.removeItem('user');\n        localStorage.removeItem('push-notification-config');\n        // Navigate to login\n        this.router.navigateByUrl('/login');\n        this.showToast('Session Expired', 'Please log in again.');\n      } catch (error) {\n        console.error('Error handling authentication error:', error);\n      }\n    }\n    showToast(header, message) {\n      try {\n        // Create a simple toast notification\n        const toast = document.createElement('div');\n        toast.style.cssText = `\n\t\t\t\tposition: fixed;\n\t\t\t\ttop: 20px;\n\t\t\t\tright: 20px;\n\t\t\t\tbackground: #f44336;\n\t\t\t\tcolor: white;\n\t\t\t\tpadding: 15px 20px;\n\t\t\t\tborder-radius: 4px;\n\t\t\t\tz-index: 10000;\n\t\t\t\tfont-family: Arial, sans-serif;\n\t\t\t\tmax-width: 300px;\n\t\t\t\tbox-shadow: 0 2px 10px rgba(0,0,0,0.3);\n\t\t\t`;\n        toast.innerHTML = `\n\t\t\t\t<div style=\"font-weight: bold; margin-bottom: 5px;\">${header}</div>\n\t\t\t\t<div>${message}</div>\n\t\t\t`;\n        document.body.appendChild(toast);\n        // Remove after 5 seconds\n        setTimeout(() => {\n          if (toast.parentNode) {\n            toast.parentNode.removeChild(toast);\n          }\n        }, 5000);\n      } catch (error) {\n        console.error('Error showing toast:', error);\n      }\n    }\n    wrapAsync(promise, context = 'Async Operation') {\n      return promise.catch(error => {\n        this.handleError(error, context);\n        throw error;\n      });\n    }\n    wrapObservable(observable, context = 'Observable Operation') {\n      return observable.pipe(\n        // Add error handling to observable\n        // This is a simplified version - in a real app you'd use RxJS operators\n      );\n    }\n    static ɵfac = function ErrorHandlerService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ErrorHandlerService)(i0.ɵɵinject(i1.Router));\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: ErrorHandlerService,\n      factory: ErrorHandlerService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return ErrorHandlerService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}