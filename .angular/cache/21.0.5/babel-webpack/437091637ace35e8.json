{"ast":null,"code":"import _asyncToGenerator from \"/Users/malaviyagautam/Code/JS/MEAN/Ionic/FULL Source Code & Database/ionic-project-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { HttpService } from '../../services/common/http.service';\nimport { MessageService } from '../../services/common/message.service';\nimport { BFGMealPlanService } from '../../services/bfg-meal-plan.service';\nimport { BFGUserService } from '../../services/bfg-user.service';\nimport moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/bfg-meal-plan.service\";\nimport * as i3 from \"../../services/bfg-user.service\";\nimport * as i4 from \"../../services/common/http.service\";\nimport * as i5 from \"../../services/common/message.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@ionic/angular\";\nimport * as i8 from \"../../components/meal-details/meal-details.component\";\nfunction WeekMenuPage_ion_menu_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-menu-button\");\n  }\n}\nfunction WeekMenuPage_ion_back_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-back-button\");\n  }\n}\nfunction WeekMenuPage_app_meal_details_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-meal-details\", 16);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"houseId\", ctx_r0.houseId)(\"details\", ctx_r0.menuDetails)(\"date\", ctx_r0.currentDate)(\"hideHeader\", true);\n  }\n}\nfunction WeekMenuPage_ion_row_43_ion_col_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-col\", 18)(1, \"ion-button\", 19);\n    i0.ɵɵlistener(\"click\", function WeekMenuPage_ion_row_43_ion_col_1_Template_ion_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.editMealPlan());\n    });\n    i0.ɵɵtext(2, \"EDIT MEAL PLAN\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction WeekMenuPage_ion_row_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\");\n    i0.ɵɵtemplate(1, WeekMenuPage_ion_row_43_ion_col_1_Template, 3, 0, \"ion-col\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isStudent);\n  }\n}\nfunction WeekMenuPage_ng_container_44_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"p\", 9);\n    i0.ɵɵtext(2, \"Want to make a meal request?\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-button\", 20)(4, \"strong\");\n    i0.ɵɵtext(5, \"REQUESTS & COMMENTS\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", \"/requests\");\n  }\n}\nfunction WeekMenuPage_ng_container_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-footer\");\n    i0.ɵɵtemplate(2, WeekMenuPage_ng_container_44_ng_container_2_Template, 6, 1, \"ng-container\", 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const loaded_r3 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isStudent && loaded_r3 && ctx_r0.bfgUser.appFunctionEnabled(\"requests_comments\"));\n  }\n}\nexport let WeekMenuPage = /*#__PURE__*/(() => {\n  class WeekMenuPage {\n    route;\n    router;\n    mealPlan;\n    bfgUser;\n    http;\n    msg;\n    menuDetails = [];\n    menuDetailsByDay = {};\n    currentDate = '';\n    menuDetailsLoaded = false;\n    initialLoad = false;\n    _startDate = '';\n    _endDate = '';\n    _currentDay = 'monday';\n    _house = '';\n    _houseId = 0;\n    get house() {\n      return this._house;\n    }\n    get houseId() {\n      return this._houseId;\n    }\n    get isStudent() {\n      return this.bfgUser.isStudent();\n    }\n    get isChef() {\n      return this.bfgUser.isChef() || this.bfgUser.isSuperChef();\n    }\n    constructor(route, router, mealPlan, bfgUser, http, msg) {\n      this.route = route;\n      this.router = router;\n      this.mealPlan = mealPlan;\n      this.bfgUser = bfgUser;\n      this.http = http;\n      this.msg = msg;\n    }\n    ngOnInit() {\n      var _this = this;\n      if (!this.initialLoad) {\n        this.route.params.subscribe(/*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (params) {\n            _this._houseId = params['houseId'];\n            if (_this._houseId) {\n              yield _this.msg.showLoader('Loading house settings, please wait...');\n              _this.bfgUser.initializeHouses().subscribe(/*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator(function* (response) {\n                  yield _this.msg.hideLoader();\n                  _this.bfgUser.switchToHouse(_this._houseId);\n                  _this.setupWeekView();\n                });\n                return function (_x2) {\n                  return _ref2.apply(this, arguments);\n                };\n              }());\n            } else {\n              _this.setupWeekView();\n            }\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      }\n    }\n    ionViewDidEnter() {\n      if (this.initialLoad) {\n        this.loadWeekView();\n      }\n    }\n    getStartDateFormatted() {\n      return this._startDate ? this._startDate.format('MMM DD, YYYY') : '';\n    }\n    getEndDateFormatted() {\n      return this._endDate ? this._endDate.format('MMM DD, YYYY') : '';\n    }\n    getDayActiveColor(day) {\n      return this._currentDay == day ? 'primary' : 'secondary';\n    }\n    switchToDay(day) {\n      this._currentDay = day;\n      this.menuDetails = this.menuDetailsByDay[this._currentDay] ? this.menuDetailsByDay[this._currentDay].meal_type_details : [];\n      this.syncCurrentDateWithDay();\n    }\n    switchToPreviousWeek() {\n      let date = moment(this._startDate).subtract(1, 'week');\n      this.setupWeekView(date);\n    }\n    switchToNextWeek() {\n      let date = moment(this._startDate).add(1, 'week');\n      this.setupWeekView(date);\n    }\n    editMealPlan() {\n      this.router.navigateByUrl('/edit-meal-plan', {\n        state: {\n          date: this.currentDate\n        }\n      });\n    }\n    syncCurrentDateWithDay() {\n      let startOfWeek = moment(this._startDate);\n      switch (this._currentDay) {\n        case 'monday':\n          // Nothing, monday is start of week\n          break;\n        case 'tuesday':\n          startOfWeek = startOfWeek.add(1, 'days');\n          break;\n        case 'wednesday':\n          startOfWeek = startOfWeek.add(2, 'days');\n          break;\n        case 'thursday':\n          startOfWeek = startOfWeek.add(3, 'days');\n          break;\n        case 'friday':\n          startOfWeek = startOfWeek.add(4, 'days');\n          break;\n        case 'saturday':\n          startOfWeek = startOfWeek.add(5, 'days');\n          break;\n        case 'sunday':\n          startOfWeek = startOfWeek.add(6, 'days');\n          break;\n      }\n      this.currentDate = startOfWeek.format('YYYY-MM-DD');\n    }\n    setupWeekView(date = '') {\n      let now = moment(date ? date : new Date());\n      // Because of how weeks are considered in moment. We want monday to be the start, so subtract back\n      if (now.format('dddd').toLowerCase() == 'sunday') {\n        this._startDate = moment(now).startOf('week').subtract(6, 'days');\n        this._endDate = moment(now);\n      } else {\n        this._startDate = moment(now).startOf('week').add(1, 'days');\n        this._endDate = moment(now).endOf('week').add(1, 'days');\n      }\n      this._currentDay = now.format('dddd').toLowerCase();\n      this.syncCurrentDateWithDay();\n      this.loadWeekView();\n    }\n    loadWeekView() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        yield _this2.msg.showLoader('Loading weekly menu, please wait...');\n        _this2.menuDetailsLoaded = false;\n        if (_this2.isStudent) {\n          _this2.http.post('bfg/meals/load-weekly-menu', {\n            start_date: _this2._startDate.format('YYYY-MM-DD'),\n            end_date: _this2._endDate.format('YYYY-MM-DD')\n          }).subscribe(/*#__PURE__*/function () {\n            var _ref3 = _asyncToGenerator(function* (response) {\n              yield _this2.msg.hideLoader();\n              _this2._house = response.house;\n              _this2.menuDetailsByDay = response.menu_details_by_day;\n              _this2.menuDetails = _this2.menuDetailsByDay[_this2._currentDay] ? _this2.menuDetailsByDay[_this2._currentDay].meal_type_details : [];\n              _this2.initialLoad = true;\n              _this2.menuDetailsLoaded = true;\n            });\n            return function (_x3) {\n              return _ref3.apply(this, arguments);\n            };\n          }());\n        } else if (_this2.isChef) {\n          _this2.http.post('bfg/house-dashboard/load-weekly-menu', {\n            start_date: _this2._startDate.format('YYYY-MM-DD'),\n            end_date: _this2._endDate.format('YYYY-MM-DD'),\n            bfg_house_id: _this2._houseId\n          }).subscribe(/*#__PURE__*/function () {\n            var _ref4 = _asyncToGenerator(function* (response) {\n              yield _this2.msg.hideLoader();\n              _this2._house = response.house;\n              _this2.menuDetailsByDay = response.menu_details_by_day;\n              _this2.menuDetails = _this2.menuDetailsByDay[_this2._currentDay] ? _this2.menuDetailsByDay[_this2._currentDay].meal_type_details : [];\n              _this2.initialLoad = true;\n              _this2.menuDetailsLoaded = true;\n            });\n            return function (_x4) {\n              return _ref4.apply(this, arguments);\n            };\n          }());\n        } else {\n          _this2.router.navigateByUrl('login');\n        }\n      })();\n    }\n    static ɵfac = function WeekMenuPage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || WeekMenuPage)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.BFGMealPlanService), i0.ɵɵdirectiveInject(i3.BFGUserService), i0.ɵɵdirectiveInject(i4.HttpService), i0.ɵɵdirectiveInject(i5.MessageService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: WeekMenuPage,\n      selectors: [[\"app-week-menu\"]],\n      standalone: false,\n      decls: 46,\n      vars: 17,\n      consts: [[\"slot\", \"start\"], [4, \"ngIf\"], [1, \"wrap-text\"], [\"no-padding\", \"\"], [1, \"date-range-nav\"], [\"size\", \"2\", \"align-self-center\", \"\"], [\"fill\", \"clear\", \"float-left\", \"\", 3, \"click\"], [\"ios\", \"ios-arrow-back\", \"md\", \"md-arrow-back\"], [\"size\", \"8\", \"align-self-center\", \"\"], [\"text-center\", \"\"], [\"fill\", \"clear\", \"float-right\", \"\", 3, \"click\"], [\"ios\", \"ios-arrow-forward\", \"md\", \"md-arrow-forward\"], [\"no-padding\", \"\", 1, \"seven-col-row\"], [\"no-padding\", \"\", 1, \"col-1\"], [\"expand\", \"full\", 3, \"click\", \"color\"], [3, \"houseId\", \"details\", \"date\", \"hideHeader\", 4, \"ngIf\"], [3, \"houseId\", \"details\", \"date\", \"hideHeader\"], [\"size\", \"12\", \"size-lg\", \"6\", \"offset-lg\", \"3\", \"padding\", \"\", 4, \"ngIf\"], [\"size\", \"12\", \"size-lg\", \"6\", \"offset-lg\", \"3\", \"padding\", \"\"], [\"expand\", \"block\", \"size\", \"large\", 1, \"blue-button\", 3, \"click\"], [\"bfg-btm-btn\", \"\", \"expand\", \"full\", \"size\", \"large\", \"color\", \"secondary\", \"expand\", \"block\", 3, \"routerLink\"]],\n      template: function WeekMenuPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n          i0.ɵɵtemplate(3, WeekMenuPage_ion_menu_button_3_Template, 1, 0, \"ion-menu-button\", 1)(4, WeekMenuPage_ion_back_button_4_Template, 1, 0, \"ion-back-button\", 1);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"ion-title\")(6, \"span\", 2);\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(8, \"ion-content\")(9, \"ion-grid\", 3)(10, \"ion-row\", 4)(11, \"ion-col\", 5)(12, \"ion-button\", 6);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_12_listener() {\n            return ctx.switchToPreviousWeek();\n          });\n          i0.ɵɵelement(13, \"ion-icon\", 7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"ion-col\", 8)(15, \"h2\", 9);\n          i0.ɵɵtext(16);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(17, \"ion-col\", 5)(18, \"ion-button\", 10);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_18_listener() {\n            return ctx.switchToNextWeek();\n          });\n          i0.ɵɵelement(19, \"ion-icon\", 11);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(20, \"ion-row\", 12)(21, \"ion-col\", 13)(22, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_22_listener() {\n            return ctx.switchToDay(\"monday\");\n          });\n          i0.ɵɵtext(23, \"MON\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(24, \"ion-col\", 13)(25, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_25_listener() {\n            return ctx.switchToDay(\"tuesday\");\n          });\n          i0.ɵɵtext(26, \"TUE\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(27, \"ion-col\", 13)(28, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_28_listener() {\n            return ctx.switchToDay(\"wednesday\");\n          });\n          i0.ɵɵtext(29, \"WED\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(30, \"ion-col\", 13)(31, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_31_listener() {\n            return ctx.switchToDay(\"thursday\");\n          });\n          i0.ɵɵtext(32, \"THU\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(33, \"ion-col\", 13)(34, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_34_listener() {\n            return ctx.switchToDay(\"friday\");\n          });\n          i0.ɵɵtext(35, \"FRI\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(36, \"ion-col\", 13)(37, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_37_listener() {\n            return ctx.switchToDay(\"saturday\");\n          });\n          i0.ɵɵtext(38, \"SAT\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(39, \"ion-col\", 13)(40, \"ion-button\", 14);\n          i0.ɵɵlistener(\"click\", function WeekMenuPage_Template_ion_button_click_40_listener() {\n            return ctx.switchToDay(\"sunday\");\n          });\n          i0.ɵɵtext(41, \"SUN\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵtemplate(42, WeekMenuPage_app_meal_details_42_Template, 1, 4, \"app-meal-details\", 15)(43, WeekMenuPage_ion_row_43_Template, 2, 1, \"ion-row\", 1);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(44, WeekMenuPage_ng_container_44_Template, 3, 1, \"ng-container\", 1);\n          i0.ɵɵpipe(45, \"async\");\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.isStudent);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.isStudent);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate1(\"\", ctx.house, \" Menu\");\n          i0.ɵɵadvance(9);\n          i0.ɵɵtextInterpolate2(\"\", ctx.getStartDateFormatted(), \" - \", ctx.getEndDateFormatted());\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"monday\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"tuesday\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"wednesday\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"thursday\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"friday\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"saturday\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"color\", ctx.getDayActiveColor(\"sunday\"));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.menuDetailsLoaded);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.menuDetailsLoaded);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(45, 15, ctx.bfgUser.userConfigLoaded));\n        }\n      },\n      dependencies: [i6.NgIf, i7.IonButton, i7.IonButtons, i7.IonCol, i7.IonContent, i7.IonFooter, i7.IonGrid, i7.IonHeader, i7.IonIcon, i7.IonMenuButton, i7.IonRow, i7.IonTitle, i7.IonToolbar, i7.IonBackButton, i7.RouterLinkDelegate, i1.RouterLink, i8.MealDetailsComponent, i6.AsyncPipe],\n      styles: [\".date-range-nav[_ngcontent-%COMP%]{background:var(--ion-color-secondary);color:var(--ion-color-tertiary)}.date-range-nav[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.15rem}.date-range-nav[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background:rgba(0,0,0,0);--color: var(--ion-color-light);--color-activated: rgba(255,255,255,.5);--color-focused:rgba(255,255,255,.5)}.seven-col-row[_ngcontent-%COMP%]   .col-1[_ngcontent-%COMP%]{width:14.2857142857%}.seven-col-row[_ngcontent-%COMP%]   .col-1[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-size:1rem;--padding-bottom: 0rem;--padding-end: 0rem;--padding-start: 0rem;--padding-top: 0rem;margin:0rem;background:var(--ion-color-tertiary);--background: var(--ion-color-tertiary);--color: var(--ion-color-secondary);--background-activated: var(--ion-color-tertiary);--background-focused: var(--ion-color-tertiary)}\"]\n    });\n  }\n  return WeekMenuPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}