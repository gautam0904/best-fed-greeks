{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { WebPlugin } from '@capacitor/core';\nexport class HttpPluginWeb extends WebPlugin {\n  constructor() {\n    super({\n      name: 'Http',\n      platforms: ['web', 'electron']\n    });\n  }\n  getRequestHeader(headers, key) {\n    const originalKeys = Object.keys(headers);\n    const keys = Object.keys(headers).map(k => k.toLocaleLowerCase());\n    const lowered = keys.reduce((newHeaders, key, index) => {\n      newHeaders[key] = headers[originalKeys[index]];\n      return newHeaders;\n    }, {});\n    return lowered[key.toLocaleLowerCase()];\n  }\n  nativeHeadersToObject(headers) {\n    const h = {};\n    headers.forEach((value, key) => {\n      h[key] = value;\n    });\n    return h;\n  }\n  makeFetchOptions(options, fetchExtra) {\n    const req = Object.assign({\n      method: options.method || 'GET',\n      headers: options.headers\n    }, fetchExtra || {});\n    const contentType = this.getRequestHeader(options.headers || {}, 'content-type') || '';\n    if (contentType.indexOf('application/json') === 0) {\n      req['body'] = JSON.stringify(options.data);\n    } else if (contentType.indexOf('application/x-www-form-urlencoded') === 0) {} else if (contentType.indexOf('multipart/form-data') === 0) {}\n    return req;\n  }\n  request(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const fetchOptions = this.makeFetchOptions(options, options.webFetchExtra);\n      const ret = yield fetch(options.url, fetchOptions);\n      const contentType = ret.headers.get('content-type');\n      let data;\n      if (contentType && contentType.indexOf('application/json') === 0) {\n        data = yield ret.json();\n      } else {\n        data = yield ret.text();\n      }\n      return {\n        status: ret.status,\n        data,\n        headers: this.nativeHeadersToObject(ret.headers)\n      };\n    });\n  }\n  setCookie(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      var expires = \"\";\n      if (options.ageDays) {\n        const date = new Date();\n        date.setTime(date.getTime() + options.ageDays * 24 * 60 * 60 * 1000);\n        expires = \"; expires=\" + date.toUTCString();\n      }\n      document.cookie = options.key + \"=\" + (options.value || \"\") + expires + \"; path=/\";\n    });\n  }\n  getCookies(_options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!document.cookie) {\n        return {\n          value: []\n        };\n      }\n      var cookies = document.cookie.split(';');\n      return {\n        value: cookies.map(c => {\n          const cParts = c.split(';').map(cv => cv.trim());\n          const cNameValue = cParts[0];\n          const cValueParts = cNameValue.split('=');\n          const key = cValueParts[0];\n          const value = cValueParts[1];\n          return {\n            key,\n            value\n          };\n        })\n      };\n    });\n  }\n  deleteCookie(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      document.cookie = options.key + '=; Max-Age=0';\n    });\n  }\n  clearCookies(_options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      document.cookie.split(\";\").forEach(c => document.cookie = c.replace(/^ +/, '').replace(/=.*/, `=;expires=${new Date().toUTCString()};path=/`));\n    });\n  }\n  uploadFile(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const fetchOptions = this.makeFetchOptions(options, options.webFetchExtra);\n      const formData = new FormData();\n      formData.append(options.name, options.blob);\n      yield fetch(options.url, Object.assign(Object.assign({}, fetchOptions), {\n        body: formData,\n        method: 'POST'\n      }));\n      return {};\n    });\n  }\n  downloadFile(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const fetchOptions = this.makeFetchOptions(options, options.webFetchExtra);\n      const ret = yield fetch(options.url, fetchOptions);\n      const blob = yield ret.blob();\n      return {\n        blob\n      };\n    });\n  }\n}\nconst Http = new HttpPluginWeb();\nexport { Http };\n//# sourceMappingURL=web.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}