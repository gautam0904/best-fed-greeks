{"ast":null,"code":"import _asyncToGenerator from \"/Users/malaviyagautam/Code/JS/MEAN/Ionic/FULL Source Code & Database/ionic-project-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { HttpService } from '../../services/common/http.service';\nimport { MessageService } from '../../services/common/message.service';\nimport { BFGUserService } from '../../services/bfg-user.service';\nimport moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/bfg-user.service\";\nimport * as i3 from \"../../services/common/http.service\";\nimport * as i4 from \"../../services/common/message.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@ionic/angular\";\nconst _c0 = a0 => [\"/chat\", a0];\nfunction HouseRosterPage_ion_content_7_ion_row_2_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Sign Ups Finalized\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_row_2_p_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Sign Up Still Active\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_row_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\")(1, \"ion-col\", 7)(2, \"h2\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, HouseRosterPage_ion_content_7_ion_row_2_p_4_Template, 2, 0, \"p\", 2)(5, HouseRosterPage_ion_content_7_ion_row_2_p_5_Template, 2, 0, \"p\", 2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.mealType, \" on \", ctx_r0.getDateFormatted());\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.finalized);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.finalized);\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_item_group_10_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-button\", 9);\n    i0.ɵɵlistener(\"click\", function HouseRosterPage_ion_content_7_ion_item_group_10_div_1_Template_ion_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const d_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.sendPickupNotification(d_r3.time_slot_signup));\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const d_r3 = i0.ɵɵnextContext().$implicit;\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.amountSignedUpForTimeSlot(d_r3.time_slot_signup), \" signed up for \", d_r3.time_slot_signup_display);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r0.timeSlotSignupNotificationSent(d_r3.time_slot_signup) || !ctx_r0.finalized);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.timeSlotSignupNotificationSent(d_r3.time_slot_signup) ? \"Notification Sent\" : ctx_r0.finalized ? \"Send Pickup Notification\" : \"Signup not finalized yet\", \" \");\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_item_group_10_ng_container_2_ion_item_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 15);\n    i0.ɵɵelement(1, \"ion-icon\", 16);\n    i0.ɵɵelementStart(2, \"p\", 17)(3, \"b\");\n    i0.ɵɵtext(4, \"Allergies:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const d_r3 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(d_r3.allergies);\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_item_group_10_ng_container_2_ion_item_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 18);\n    i0.ɵɵelement(1, \"ion-icon\", 16);\n    i0.ɵɵelementStart(2, \"p\", 19)(3, \"b\");\n    i0.ɵɵtext(4, \"Diet: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const d_r3 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(d_r3.dietary_preferences);\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_item_group_10_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-item\", 10);\n    i0.ɵɵelement(2, \"ion-icon\", 11);\n    i0.ɵɵelementStart(3, \"h3\", 12);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(5, HouseRosterPage_ion_content_7_ion_item_group_10_ng_container_2_ion_item_5_Template, 7, 1, \"ion-item\", 13)(6, HouseRosterPage_ion_content_7_ion_item_group_10_ng_container_2_ion_item_6_Template, 7, 1, \"ion-item\", 14);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const d_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\"\", d_r3.name, \" \", d_r3.live_out_designation ? \"(Living Out Of House)\" : \"\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", d_r3.allergies);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", d_r3.dietary_preferences);\n  }\n}\nfunction HouseRosterPage_ion_content_7_ion_item_group_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item-group\");\n    i0.ɵɵtemplate(1, HouseRosterPage_ion_content_7_ion_item_group_10_div_1_Template, 5, 4, \"div\", 8)(2, HouseRosterPage_ion_content_7_ion_item_group_10_ng_container_2_Template, 7, 4, \"ng-container\", 2);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const d_r3 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", d_r3.time_slot_signup && d_r3.is_group);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !d_r3.is_group);\n  }\n}\nfunction HouseRosterPage_ion_content_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-content\")(1, \"ion-grid\", 3);\n    i0.ɵɵtemplate(2, HouseRosterPage_ion_content_7_ion_row_2_Template, 6, 4, \"ion-row\", 2);\n    i0.ɵɵelementStart(3, \"ion-row\", 4)(4, \"ion-col\", 5)(5, \"ion-list\")(6, \"ion-list-header\")(7, \"ion-label\")(8, \"h2\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(10, HouseRosterPage_ion_content_7_ion_item_group_10_Template, 3, 2, \"ion-item-group\", 6);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.mealType);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\"Total Students: \", ctx_r0.usersSignedUp);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.users);\n  }\n}\nfunction HouseRosterPage_ng_container_9_ion_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-button\", 21)(1, \"strong\");\n    i0.ɵɵtext(2, \"Message House\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(1, _c0, ctx_r0.houseId));\n  }\n}\nfunction HouseRosterPage_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, HouseRosterPage_ng_container_9_ion_button_1_Template, 3, 3, \"ion-button\", 20);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.bfgUser.appFunctionEnabled(\"chat\"));\n  }\n}\nexport let HouseRosterPage = /*#__PURE__*/(() => {\n  class HouseRosterPage {\n    route;\n    router;\n    bfgUser;\n    http;\n    msg;\n    users = [];\n    loaded = false;\n    mealType = '';\n    finalized = false;\n    usersSignedUp = 0;\n    houseName = '';\n    /*\n    public data = [\n    // TODO Make Icons populate remove-circle icon and text color red if allergy and diet are not null\n    // TODO Make Icons populate alert icon and text color yellow if allergy or diet are not null - not both\n    // TODO Make Icons populate checkmark-circle icon and text color green if allergy and diet are both null\n    // TODO If studentAllergy is null print string 'No Allergies'\n    // TODO If studentDiet is null print string 'No Dietary Restrictions'\n    {\n        statusIcon: 'remove-circle',\n        studentName: 'Student 1',\n        studentAllergy: 'Seafood',\n        studentDiet: 'Vegetarian',\n    },\n    {\n        statusIcon: 'checkmark-circle',\n        studentName: 'Student 2',\n        studentAllergy: null,\n        studentDiet: null,\n    },\n    {\n        statusIcon: 'alert',\n        studentName: 'Student 3',\n        studentAllergy: null,\n        studentDiet: 'Gluten Free',\n    },\n    {\n        statusIcon: 'alert',\n        studentName: 'Student 4',\n        studentAllergy: null,\n        studentDiet: 'Vegetarian',\n    },]*/\n    _houseId = 0;\n    _date = '';\n    _mealType = '';\n    _timeSlotsSeen = [];\n    _timeSlotsSignupDetails = {};\n    get houseId() {\n      return this._houseId;\n    }\n    constructor(route, router, bfgUser, http, msg) {\n      this.route = route;\n      this.router = router;\n      this.bfgUser = bfgUser;\n      this.http = http;\n      this.msg = msg;\n    }\n    ngOnInit() {\n      var _this = this;\n      this.route.params.subscribe(/*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (params) {\n          _this._houseId = params['houseId'];\n          if (params['mealType']) {\n            _this._date = params['date'];\n            _this._mealType = params['mealType'];\n          }\n          if (_this._houseId) {\n            yield _this.msg.showLoader('Loading house settings, please wait...');\n            _this.bfgUser.initializeHouses().subscribe(/*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator(function* (response) {\n                yield _this.msg.hideLoader();\n                _this.bfgUser.switchToHouse(_this._houseId);\n                _this.load();\n              });\n              return function (_x2) {\n                return _ref2.apply(this, arguments);\n              };\n            }());\n          } else {\n            _this.load();\n          }\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n    getDateFormatted() {\n      return this._date ? moment(this._date).format('MMM DD, YYYY') : '';\n    }\n    sendPickupNotification(timeSlot) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        yield _this2.msg.showLoader();\n        _this2.http.post('bfg/house-dashboard/send-time-slot-signup-pickup-notification', {\n          date: _this2._date,\n          meal_type: _this2._mealType,\n          bfg_house_id: _this2._houseId,\n          time_slot: timeSlot\n        }).subscribe(/*#__PURE__*/function () {\n          var _ref3 = _asyncToGenerator(function* (response) {\n            yield _this2.msg.hideLoader();\n            if (response.success) {\n              _this2._timeSlotsSignupDetails[timeSlot].notification_sent = true;\n            }\n          });\n          return function (_x3) {\n            return _ref3.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    amountSignedUpForTimeSlot(timeSlot) {\n      return this._timeSlotsSignupDetails[timeSlot] ? this._timeSlotsSignupDetails[timeSlot].signup_amount : 0;\n    }\n    timeSlotSignupNotificationSent(timeSlot) {\n      return this._timeSlotsSignupDetails[timeSlot] ? this._timeSlotsSignupDetails[timeSlot].notification_sent : false;\n    }\n    load() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        yield _this3.msg.showLoader();\n        _this3.http.post('bfg/house-dashboard/load-roster', {\n          date: _this3._date,\n          meal_type: _this3._mealType,\n          bfg_house_id: _this3._houseId\n        }).subscribe(/*#__PURE__*/function () {\n          var _ref4 = _asyncToGenerator(function* (response) {\n            yield _this3.msg.hideLoader();\n            _this3._timeSlotsSignupDetails = response.signup_slot_details;\n            _this3._timeSlotsSeen = [];\n            let users = response.users;\n            _this3.usersSignedUp = 0;\n            users = users.map(user => {\n              if (user['allergies']) {\n                user.statusIcon = 'remove-circle';\n              } else if (user['dietary_preferences']) {\n                user.statusIcon = 'alert';\n              } else {\n                user.statusIcon = 'checkmark-circle';\n              }\n              return user;\n            });\n            let allData = [];\n            let timeSlotSignupsSeen = [];\n            users.forEach(user => {\n              _this3.usersSignedUp++;\n              if (user.time_slot_signup && timeSlotSignupsSeen.indexOf(user.time_slot_signup) == -1) {\n                timeSlotSignupsSeen.push(user.time_slot_signup);\n                allData.push({\n                  is_group: true,\n                  time_slot_signup: user.time_slot_signup,\n                  time_slot_signup_display: user.time_slot_signup_display\n                });\n              }\n              allData.push(user);\n            });\n            _this3.houseName = response.houseName;\n            _this3.users = allData;\n            _this3.mealType = response.meal_type;\n            _this3.finalized = !!response.finalized;\n            _this3.loaded = true;\n          });\n          return function (_x4) {\n            return _ref4.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    static ɵfac = function HouseRosterPage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || HouseRosterPage)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.BFGUserService), i0.ɵɵdirectiveInject(i3.HttpService), i0.ɵɵdirectiveInject(i4.MessageService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: HouseRosterPage,\n      selectors: [[\"app-house-roster\"]],\n      standalone: false,\n      decls: 12,\n      vars: 7,\n      consts: [[\"slot\", \"start\"], [1, \"wrap-text\"], [4, \"ngIf\"], [\"no-padding\", \"\"], [\"padding\", \"\"], [\"size\", \"12\", \"size-lg\", \"6\", \"offset-lg\", \"3\", \"no-padding\", \"\", 1, \"roster\"], [4, \"ngFor\", \"ngForOf\"], [\"size\", \"12\", 1, \"profile-top\"], [\"size\", \"12\", \"class\", \"profile-top\", 4, \"ngIf\"], [\"color\", \"primary\", 3, \"click\", \"disabled\"], [\"lines\", \"full\", \"color\", \"light\"], [\"name\", \"contact\", \"slot\", \"start\"], [1, \"student-name\"], [\"lines\", \"full\", \"color\", \"warning\", 4, \"ngIf\"], [\"lines\", \"none\", \"color\", \"warning\", 4, \"ngIf\"], [\"lines\", \"full\", \"color\", \"warning\"], [\"name\", \"alert\", \"slot\", \"start\"], [1, \"student-allergy\"], [\"lines\", \"none\", \"color\", \"warning\"], [1, \"student-diet\"], [\"bfg-btm-btn\", \"\", \"expand\", \"full\", \"size\", \"large\", \"color\", \"primary\", \"expand\", \"block\", \"size\", \"large\", 3, \"routerLink\", 4, \"ngIf\"], [\"bfg-btm-btn\", \"\", \"expand\", \"full\", \"size\", \"large\", \"color\", \"primary\", \"expand\", \"block\", \"size\", \"large\", 3, \"routerLink\"]],\n      template: function HouseRosterPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n          i0.ɵɵelement(3, \"ion-back-button\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"ion-title\")(5, \"span\", 1);\n          i0.ɵɵtext(6);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵtemplate(7, HouseRosterPage_ion_content_7_Template, 11, 3, \"ion-content\", 2);\n          i0.ɵɵelementStart(8, \"ion-footer\");\n          i0.ɵɵtemplate(9, HouseRosterPage_ng_container_9_Template, 2, 1, \"ng-container\", 2);\n          i0.ɵɵpipe(10, \"async\");\n          i0.ɵɵpipe(11, \"async\");\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate1(\"\", ctx.houseName, \" Roster\");\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.loaded);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(10, 3, ctx.bfgUser.userConfigLoaded) || i0.ɵɵpipeBind1(11, 5, ctx.bfgUser.houseChanged));\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf, i6.IonButton, i6.IonButtons, i6.IonCol, i6.IonContent, i6.IonFooter, i6.IonGrid, i6.IonHeader, i6.IonIcon, i6.IonItem, i6.IonItemGroup, i6.IonLabel, i6.IonList, i6.IonListHeader, i6.IonRow, i6.IonTitle, i6.IonToolbar, i6.IonBackButton, i6.RouterLinkDelegate, i1.RouterLink, i5.AsyncPipe],\n      styles: [\".roster[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{--background: var(--ion-color-secondary);--color: white}.roster[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{white-space:pre-wrap;font-weight:900}.roster[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: white}.roster[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{white-space:pre-wrap;font-size:1.25rem;font-weight:900}.roster[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.15rem;line-height:1.5rem;white-space:pre-wrap}.profile-top[_ngcontent-%COMP%]{background-color:var(--ion-color-secondary);color:#fff;padding:.5rem 1rem 1rem}\"]\n    });\n  }\n  return HouseRosterPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}