{"ast":null,"code":"import _asyncToGenerator from \"/Users/malaviyagautam/Code/JS/MEAN/Ionic/FULL Source Code & Database/ionic-project-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpService } from '../../services/common/http.service';\nimport { MessageService } from '../../services/common/message.service';\nimport { BFGUserService } from '../../services/bfg-user.service';\nimport { BFGPushNotificationService } from '../../services/bfg-push-notification.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/bfg-user.service\";\nimport * as i2 from \"../../services/bfg-push-notification.service\";\nimport * as i3 from \"../../services/common/http.service\";\nimport * as i4 from \"../../services/common/message.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@ionic/angular\";\nimport * as i8 from \"../../components/forms/allergies/allergies.component\";\nimport * as i9 from \"../../components/forms/diet/diet.component\";\nfunction ProfilePage_ion_grid_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-grid\", 5)(1, \"ion-row\")(2, \"ion-col\", 6);\n    i0.ɵɵtext(3, \". \");\n    i0.ɵɵelementStart(4, \"h3\");\n    i0.ɵɵtext(5, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"ion-list\")(7, \"ion-item\")(8, \"ion-input\", 7);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_ion_grid_10_Template_ion_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.name, $event) || (ctx_r2.name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(9, \"ion-col\", 6)(10, \"h3\");\n    i0.ɵɵtext(11, \"House\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"ion-list\")(13, \"ion-item\")(14, \"ion-input\", 8);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_ion_grid_10_Template_ion_input_ngModelChange_14_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.house, $event) || (ctx_r2.house = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(15, \"ion-col\", 6);\n    i0.ɵɵelement(16, \"app-allergies\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"ion-col\", 6);\n    i0.ɵɵelement(18, \"app-diet\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-col\", 6)(20, \"h3\");\n    i0.ɵɵtext(21, \"Living Out Of House?\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"ion-list\")(23, \"ion-item\")(24, \"ion-toggle\", 11);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_ion_grid_10_Template_ion_toggle_ngModelChange_24_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.liveOutDesignation, $event) || (ctx_r2.liveOutDesignation = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(25, \"ion-col\", 6)(26, \"h3\");\n    i0.ɵɵtext(27, \"Enable Chat Notifications\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"ion-list\")(29, \"ion-item\")(30, \"ion-toggle\", 12);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_ion_grid_10_Template_ion_toggle_ngModelChange_30_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.subscribedToChat, $event) || (ctx_r2.subscribedToChat = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(31, \"ion-row\")(32, \"ion-col\", 6)(33, \"h3\");\n    i0.ɵɵtext(34, \"Change Password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"form\")(36, \"ion-list\")(37, \"ion-item\")(38, \"ion-input\", 13);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_ion_grid_10_Template_ion_input_ngModelChange_38_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.account.password, $event) || (ctx_r2.account.password = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(39, \"ion-list\")(40, \"ion-item\")(41, \"ion-input\", 14);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_ion_grid_10_Template_ion_input_ngModelChange_41_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.account.password_confirmation, $event) || (ctx_r2.account.password_confirmation = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.name);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.house);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"allergies\", ctx_r2.allergies);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"diet\", ctx_r2.diet);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.liveOutDesignation);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.subscribedToChat);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.account.password);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.account.password_confirmation);\n  }\n}\nexport let ProfilePage = /*#__PURE__*/(() => {\n  class ProfilePage {\n    bfgUser;\n    push;\n    http;\n    msg;\n    account = {\n      name: '',\n      password: '',\n      password_confirmation: ''\n    };\n    house = '';\n    name = '';\n    loaded = false;\n    allergies = [];\n    diet = [];\n    subscribedToChat = false;\n    liveOutDesignation = false;\n    constructor(bfgUser, push, http, msg) {\n      this.bfgUser = bfgUser;\n      this.push = push;\n      this.http = http;\n      this.msg = msg;\n    }\n    ionViewDidEnter() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        yield _this.msg.showLoader();\n        _this.http.post('bfg/user/load-profile', {}).subscribe(/*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (response) {\n            yield _this.msg.hideLoader();\n            _this.house = response.house;\n            _this.name = _this.bfgUser.user.name;\n            _this.allergies = response.allergies;\n            _this.diet = response.dietary_preferences;\n            _this.liveOutDesignation = response.live_out_designation;\n            _this.subscribedToChat = _this.push.isSubscribedToChat(_this.bfgUser.user.bfg_house_id);\n            // this.hasMealServiceToday = !!response.has_meal_service_today;\n            // this.menuDayDetails = response.menu_day_details;\n            // this.day = response.day;\n            // this.date = response.date;\n            _this.loaded = true;\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    save(form) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        let checkedAllergyIds = [],\n          checkedDietIds = [];\n        if (!form.valid) return;\n        if (_this2.subscribedToChat) {\n          _this2.push.subscribeToChat(_this2.bfgUser, _this2.bfgUser.user.bfg_house_id);\n        } else {\n          _this2.push.unsubscribeFromChat(_this2.bfgUser, _this2.bfgUser.user.bfg_house_id);\n        }\n        _this2.bfgUser.name = _this2.name;\n        _this2.allergies.forEach(function (allergy) {\n          if (allergy.checked) {\n            checkedAllergyIds.push(allergy.id);\n          }\n        });\n        _this2.diet.forEach(function (d) {\n          if (d.checked) {\n            checkedDietIds.push(d.id);\n          }\n        });\n        yield _this2.msg.showLoader('Saving profile settings, please wait...');\n        _this2.http.post('bfg/user/save-profile', {\n          name: _this2.name,\n          allergy_ids: checkedAllergyIds,\n          diet_ids: checkedDietIds,\n          live_out_designation: _this2.liveOutDesignation ? 1 : 0,\n          account: _this2.account\n        }).subscribe(/*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (response) {\n            yield _this2.msg.hideLoader();\n            if (!response['success']) {\n              yield _this2.msg.showToast('Error', response['message'] ? response['message'] : 'An error occurred while saving. Please contact us if this continues.');\n            } else {\n              _this2.account.password = '';\n              _this2.account.password_confirmation = '';\n              yield _this2.msg.showToast('Success', 'Profile settings saved successfully');\n            }\n          });\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    static ɵfac = function ProfilePage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ProfilePage)(i0.ɵɵdirectiveInject(i1.BFGUserService), i0.ɵɵdirectiveInject(i2.BFGPushNotificationService), i0.ɵɵdirectiveInject(i3.HttpService), i0.ɵɵdirectiveInject(i4.MessageService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProfilePage,\n      selectors: [[\"app-profile\"]],\n      standalone: false,\n      decls: 15,\n      vars: 1,\n      consts: [[\"profileForm\", \"ngForm\"], [\"slot\", \"start\"], [1, \"wrap-text\"], [\"no-padding\", \"\", 4, \"ngIf\"], [\"bfg-btm-btn\", \"\", \"expand\", \"full\", \"size\", \"large\", \"color\", \"primary\", 3, \"click\"], [\"no-padding\", \"\"], [\"size\", \"12\", \"size-lg\", \"6\", \"offset-lg\", \"3\", \"padding\", \"\"], [\"name\", \"name\", \"type\", \"text\", \"spellcheck\", \"false\", \"autocapitalize\", \"off\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"name\", \"house\", \"type\", \"text\", \"spellcheck\", \"false\", \"autocapitalize\", \"off\", \"required\", \"\", \"readonly\", \"\", 3, \"ngModelChange\", \"ngModel\"], [3, \"allergies\"], [3, \"diet\"], [\"name\", \"liveOutDesignation\", 3, \"ngModelChange\", \"ngModel\"], [\"name\", \"subscribedToChat\", 3, \"ngModelChange\", \"ngModel\"], [\"name\", \"password\", \"type\", \"password\", \"spellcheck\", \"false\", \"autocapitalize\", \"off\", \"required\", \"\", \"placeholder\", \"New Password\", 3, \"ngModelChange\", \"ngModel\"], [\"name\", \"password_confirmation\", \"type\", \"password\", \"spellcheck\", \"false\", \"autocapitalize\", \"off\", \"required\", \"\", \"placeholder\", \"Confirm Password\", 3, \"ngModelChange\", \"ngModel\"]],\n      template: function ProfilePage_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 1);\n          i0.ɵɵelement(3, \"ion-menu-button\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"ion-title\")(5, \"span\", 2);\n          i0.ɵɵtext(6, \"PROFILE\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(7, \"ion-content\")(8, \"form\", null, 0);\n          i0.ɵɵtemplate(10, ProfilePage_ion_grid_10_Template, 42, 8, \"ion-grid\", 3);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(11, \"ion-footer\")(12, \"ion-button\", 4);\n          i0.ɵɵlistener(\"click\", function ProfilePage_Template_ion_button_click_12_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const profileForm_r4 = i0.ɵɵreference(9);\n            return i0.ɵɵresetView(ctx.save(profileForm_r4));\n          });\n          i0.ɵɵelementStart(13, \"strong\");\n          i0.ɵɵtext(14, \"Save\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngIf\", ctx.loaded);\n        }\n      },\n      dependencies: [i5.NgIf, i6.ɵNgNoValidate, i6.NgControlStatus, i6.NgControlStatusGroup, i6.RequiredValidator, i6.NgModel, i6.NgForm, i7.IonButton, i7.IonButtons, i7.IonCol, i7.IonContent, i7.IonFooter, i7.IonGrid, i7.IonHeader, i7.IonInput, i7.IonItem, i7.IonList, i7.IonMenuButton, i7.IonRow, i7.IonTitle, i7.IonToggle, i7.IonToolbar, i7.BooleanValueAccessor, i7.TextValueAccessor, i8.AllergiesComponent, i9.DietComponent],\n      styles: [\".profile-top[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);color:var(--ion-color-light);padding:1.25rem}.profile-top[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:700;font-size:2.5rem;line-height:2rem}.profile-top[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:400;font-size:1.5rem;line-height:1rem}ion-col[_ngcontent-%COMP%]{padding-bottom:0;padding-top:0xp}\"]\n    });\n  }\n  return ProfilePage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}