{"ast":null,"code":"import _asyncToGenerator from \"/Users/malaviyagautam/Code/JS/MEAN/Ionic/FULL Source Code & Database/ionic-project-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Router } from '@angular/router';\nimport { Platform } from '@ionic/angular';\nimport { BFGUserService } from '../../services/bfg-user.service';\nimport { MessageService } from '../../services/common/message.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/common/message.service\";\nimport * as i2 from \"../../services/bfg-user.service\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/forms\";\nexport let LoginPage = /*#__PURE__*/(() => {\n  class LoginPage {\n    msg;\n    bfgUser;\n    platform;\n    router;\n    login = {\n      username: '',\n      password: ''\n    };\n    submitted = false;\n    _loader;\n    constructor(msg, bfgUser, platform, router) {\n      this.msg = msg;\n      this.bfgUser = bfgUser;\n      this.platform = platform;\n      this.router = router;\n    }\n    ionViewDidEnter() {\n      var isAuthenticated = this.bfgUser.isAuthenticated();\n      if (isAuthenticated && this.bfgUser.isStudent()) {\n        this.router.navigateByUrl('/dashboard');\n      } else if (isAuthenticated && (this.bfgUser.isChef() || this.bfgUser.isSuperChef())) {\n        this.router.navigateByUrl('/house-list');\n      }\n    }\n    onLogin(form) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        _this.submitted = true;\n        if (form.valid) {\n          yield _this.msg.showLoader('Authenticating, please wait...');\n          // setTimeout(async () => {\n          // \tawait this.msg.hideLoader();\n          // \tthis.bfgUser.loginMockUser();\n          // \tthis.router.navigateByUrl('/dashboard');\n          // }, 100);\n          _this.bfgUser.login(_this.login.username, _this.login.password).subscribe(/*#__PURE__*/function () {\n            var _ref = _asyncToGenerator(function* (response) {\n              yield _this.msg.hideLoader();\n              if (!response.error) {\n                console.log('Full login response:', JSON.stringify(response, null, 2));\n                console.log('User roles/permissions check:', {\n                  user_type: _this.bfgUser.user?.user_type,\n                  role: _this.bfgUser.user?.role,\n                  roles: _this.bfgUser.user?.roles,\n                  permissions: _this.bfgUser.user?.permissions\n                });\n                if (_this.bfgUser.isStudent()) {\n                  console.log('Navigating to dashboard...');\n                  _this.router.navigateByUrl('/dashboard');\n                } else if (_this.bfgUser.isChef() || _this.bfgUser.isSuperChef()) {\n                  console.log('Navigating to house-list...');\n                  _this.router.navigateByUrl('/house-list');\n                } else {\n                  console.log('Unknown user type:', _this.bfgUser.user?.user_type);\n                  _this.msg.showToast('Error', 'Unable to determine access. Please contact technical support');\n                }\n              }\n            });\n            return function (_x) {\n              return _ref.apply(this, arguments);\n            };\n          }());\n        }\n      })();\n    }\n    onSignup() {\n      this.router.navigateByUrl('/register');\n    }\n    static ɵfac = function LoginPage_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || LoginPage)(i0.ɵɵdirectiveInject(i1.MessageService), i0.ɵɵdirectiveInject(i2.BFGUserService), i0.ɵɵdirectiveInject(i3.Platform), i0.ɵɵdirectiveInject(i4.Router));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: LoginPage,\n      selectors: [[\"page-login\"]],\n      standalone: false,\n      decls: 38,\n      vars: 5,\n      consts: [[\"loginForm\", \"ngForm\"], [\"username\", \"ngModel\"], [\"password\", \"ngModel\"], [\"color\", \"tertiary\", \"slot\", \"start\"], [\"color\", \"tertiary\", \"defaultHref\", \"/welcome\"], [\"padding\", \"\", \"color\", \"tertiary\", 1, \"dark-grid\"], [\"padding\", \"\"], [\"color\", \"tertiary\", \"size\", \"12\", \"size-lg\", \"6\", \"offset-lg\", \"3\", \"size-xl\", \"4\", \"offset-xl\", \"4\"], [\"src\", \"../../assets/img/best-fed-greeks-logo.png\", \"alt\", \"Best Fed Greeks Logo\"], [\"size\", \"12\", \"size-lg\", \"6\", \"offset-lg\", \"3\"], [\"color\", \"secondary\"], [\"color\", \"secondary\", 1, \"secondary-text\"], [\"novalidate\", \"\"], [1, \"no-padding-inline-start\"], [\"color\", \"secondary\", \"name\", \"username\", \"type\", \"text\", \"spellcheck\", \"false\", \"autocapitalize\", \"off\", \"placeholder\", \"Username\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"color\", \"danger\"], [1, \"ion-padding-start\", \"secondary-text-danger\", 3, \"hidden\"], [\"color\", \"secondary\", \"name\", \"password\", \"type\", \"password\", \"placeholder\", \"Password\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"color\", \"secondary\", \"type\", \"submit\", \"expand\", \"block\", \"size\", \"large\", 3, \"click\"], [\"bfg-btm-btn\", \"\", \"expand\", \"full\", \"size\", \"large\", \"color\", \"secondary\", \"expand\", \"block\", \"size\", \"large\", 3, \"routerLink\"]],\n      template: function LoginPage_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 3);\n          i0.ɵɵelement(3, \"ion-back-button\", 4);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(4, \"ion-content\")(5, \"ion-grid\", 5)(6, \"ion-row\", 6)(7, \"ion-col\", 7);\n          i0.ɵɵelement(8, \"img\", 8);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(9, \"ion-grid\", 6)(10, \"ion-row\", 6)(11, \"ion-col\", 9)(12, \"ion-label\", 10);\n          i0.ɵɵtext(13, \"Login\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"p\", 11);\n          i0.ɵɵtext(15, \"Please login to continue.\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"form\", 12, 0)(18, \"ion-list\", 13)(19, \"ion-item\")(20, \"ion-input\", 14, 1);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginPage_Template_ion_input_ngModelChange_20_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.login.username, $event) || (ctx.login.username = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(22, \"ion-text\", 15)(23, \"p\", 16);\n          i0.ɵɵtext(24, \" Username is required \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(25, \"ion-item\")(26, \"ion-input\", 17, 2);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginPage_Template_ion_input_ngModelChange_26_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.login.password, $event) || (ctx.login.password = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(28, \"ion-text\", 15)(29, \"p\", 16);\n          i0.ɵɵtext(30, \" Password is required \");\n          i0.ɵɵelementEnd()()()()()();\n          i0.ɵɵelementStart(31, \"ion-row\", 6)(32, \"ion-col\", 9)(33, \"ion-button\", 18);\n          i0.ɵɵlistener(\"click\", function LoginPage_Template_ion_button_click_33_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const loginForm_r2 = i0.ɵɵreference(17);\n            return i0.ɵɵresetView(ctx.onLogin(loginForm_r2));\n          });\n          i0.ɵɵtext(34, \"Login\");\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵelementStart(35, \"ion-footer\")(36, \"ion-button\", 19);\n          i0.ɵɵtext(37, \"Forgot Password?\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          const username_r3 = i0.ɵɵreference(21);\n          const password_r4 = i0.ɵɵreference(27);\n          i0.ɵɵadvance(20);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.login.username);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"hidden\", username_r3.valid || ctx.submitted == false);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.login.password);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"hidden\", password_r4.valid || ctx.submitted == false);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"routerLink\", \"/password-reset\");\n        }\n      },\n      dependencies: [i5.ɵNgNoValidate, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.NgModel, i5.NgForm, i3.IonButton, i3.IonButtons, i3.IonCol, i3.IonContent, i3.IonFooter, i3.IonGrid, i3.IonHeader, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonList, i3.IonRow, i3.IonText, i3.IonToolbar, i3.TextValueAccessor, i3.IonBackButton, i3.RouterLinkDelegate, i4.RouterLink],\n      styles: [\".login-logo[_ngcontent-%COMP%]{padding:20px 0;min-height:200px;text-align:center}.login-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:150px}.list[_ngcontent-%COMP%]{margin-bottom:0}img[_ngcontent-%COMP%]{width:60%;display:block;margin-left:auto;margin-right:auto}\"]\n    });\n  }\n  return LoginPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}